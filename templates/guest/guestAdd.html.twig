{% extends "inline.html.twig" %}

{% block main %}
	<div class="container-fluid">
		<div class="row mt-3 text-center">
			<div class="col-md-3 col-sm-12 m-3">

				<a href="{{ path('event_show',{'userId':app.user}) }}">
					<button class="btn validationButton bgColorTwo border-0">Revoir mes évènements</button>
				</a>
			</div>
			<div class="col-12 col-md-6 mt-3">
				<p class="ranchoStyle h5">Evènement :
					{{event.theme | title }}
					- Date :
					{{event.date|format_datetime('full','short', locale='fr')}}</p>
			</div>
		</div>


		<div class="row d-flex justify-content-around">

			<div class="col-md-3 col-sm-12 text-center">
				<p class="h5 ranchoStyle my-5">...Qui seront vos invités?</p>
				
				<div class="cards col-12 px-0">
					<div class="cardHeader ranchoStyle bgColorTwo">Ajouter des invités</div>
					<div class="cardBody p-1">
						{{ form_start(guestForm) }}
						{{ form_widget(guestForm) }}
						<button type="submit" class=" btn validationButton bgColorTwo" style="padding-bottom: 1px;padding-top: 1px;">Ajouter</button>
						{{ form_end(guestForm) }}
					</div>
				</div>
			</div>

			<div class="col-md-3 text-center">
				<p class="h5 ranchoStyle my-5">Invitations en attente d'envoi :</p>
				<table class="table table-striped table-dark" style="width:100%;">

					{% if event.guests | length < 1 %}
						<p class="ranchoStyle text-info">
							Vous n'avez pas d'invitation en attente!
						</p>
					{% endif %}

					{% set break = false %}
					{% for guest in event.guests %}
						{% if guest.sent == false %}
							<tr>
								<td>{{guest.user.firstName}}</td>
								<td>{{guest.user.email}}</td>
								<td>
									<a type="button" class="badge badge-danger rounded-circle" title="supprimer" href="{{ path('guest_delete',{'eventId': event.id, 'userId' : guest.id}) }}">X</a>
								</td>
							</tr>
							{% if guest.sent == true %}
								{% set break = true %}
								<p>
									<strong>Vous n'avez pas d'invitation en attente!</strong>
								</p>
							{% endif %}
						{% endif %}
					{% endfor %}

				</table>
				<div class="py-5">
					{% if event.guests | length >= 1 %}

					<form action="{{ path('invitation_sent',{'eventId': event.id})}}" method="Post">
						<button type="submit" class=" btn validationButton bgColorTwo" value="1" name="confirmEmail">Envoyer les invitations</button>
					</form>
					
					{% endif %}
				</div>

			</div>

			<div class="col-md-3 text-center">
				<p class="h5 ranchoStyle my-5">Invitations déja envoyées à :</p>
				<table class="table table-striped table-dark" style="width:100%;">
					{% for guest in event.guests %}
						{% if guest.sent == true %}
							<tr>
								<td>{{ loop.index }}</td>
								<td>{{ guest.user.firstName }}</td>
								<td>{{ guest.user.email }}</td>
							</tr>
						{% endif %}
					{% endfor %}
				</table><br><br>
			</div>


		</div>
	</div>
</div>{% endblock %}
